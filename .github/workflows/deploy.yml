name: Deploy to Hostinger

on:

  push:

    branches:

      - main

jobs:

  deploy:

    runs-on: ubuntu-latest

    steps:

      - name: Checkout code

        uses: actions/checkout@v4

      - name: Setup SSH

        run: |

          mkdir -p ~/.ssh

          echo "${{ secrets.HOSTINGER_SSH_KEY }}" > ~/.ssh/deploy_key

          chmod 600 ~/.ssh/deploy_key

          ssh-keyscan -p ${{ secrets.HOSTINGER_PORT }} -H ${{ secrets.HOSTINGER_HOST }} >> ~/.ssh/known_hosts

      - name: Deploy theme to Hostinger

        run: |

          rsync -avz --delete \

            -e "ssh -i ~/.ssh/deploy_key -p ${{ secrets.HOSTINGER_PORT }} -o StrictHostKeyChecking=no" \

            --exclude 'node_modules' \

            --exclude '.git' \

            --exclude '.github' \

            --exclude '.ddev' \

            --exclude 'package-lock.json' \

            --exclude 'yarn.lock' \

            --exclude '.gitignore' \

            ./ ${{ secrets.HOSTINGER_USER }}@${{ secrets.HOSTINGER_HOST }}:${{ secrets.HOSTINGER_PATH }}/wp-content/themes/nlcpayroll/

      - name: Cleanup

        if: always()

        run: rm -f ~/.ssh/deploy_key
 